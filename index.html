<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kiosk Demo — Tailwind + SVG Hotspots</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-zinc-950 text-zinc-100">
  <!-- Header -->
  <header class="sticky top-0 z-40 bg-zinc-900/90 backdrop-blur border-b border-zinc-800">
    <div class="max-w-6xl mx-auto flex items-center justify-between px-4 py-3">
      <div class="font-bold">Kiosk Demo</div>
      <nav class="flex gap-2">
        <button data-page="page1" class="px-3 py-2 rounded-md bg-emerald-500 text-black font-semibold">Kaart 1</button>
        <button data-page="page2" class="px-3 py-2 rounded-md bg-zinc-800 text-zinc-100">Kaart 2</button>
        <button data-page="checkout" class="px-3 py-2 rounded-md bg-zinc-800 text-zinc-100 inline-flex items-center">
          <svg class="w-4 h-4 mr-1" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M3 3h2l.4 2M7 13h10l3-8H6.4M7 13L5.4 5M7 13l-2 5h12m-6 0a1 1 0 110-2 1 1 0 010 2zm6 0a1 1 0 110-2 1 1 0 010 2z" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Mandje <span id="cartCount" class="ml-1 inline-flex items-center justify-center min-w-[18px] h-[18px] px-1.5 rounded-full bg-emerald-500 text-black text-[12px] font-extrabold">0</span>
        </button>
      </nav>
    </div>
  </header>

  <!-- Pagina 1 -->
  <section id="page1" class="max-w-6xl mx-auto p-4 grid gap-4 grid-cols-1 lg:grid-cols-3">
    <div class="lg:col-span-2 bg-zinc-900 border border-zinc-800 rounded-xl overflow-hidden">
      <h2 class="m-0 px-4 py-3 bg-zinc-800 border-b border-zinc-700 font-semibold">Kaart 1</h2>
      <div class="p-3">
        <div class="map">
          <svg viewBox="0 0 1600 900" class="w-full h-auto">
            <image href="https://picsum.dev/1600/900" x="0" y="0" width="1600" height="900" />
          </svg>
        </div>
      </div>
    </div>
    <aside class="bg-zinc-900 border border-zinc-800 rounded-xl overflow-hidden">
      <h2 class="m-0 px-4 py-3 bg-zinc-800 border-b border-zinc-700 font-semibold">Je selectie</h2>
      <div class="p-3">
        <div id="list1" class="grid gap-2"></div>
      </div>
    </aside>
  </section>

  <!-- Pagina 2 -->
  <section id="page2" class="max-w-6xl mx-auto p-4 grid gap-4 grid-cols-1 lg:grid-cols-3 hidden">
    <div class="lg:col-span-2 bg-zinc-900 border border-zinc-800 rounded-xl overflow-hidden">
      <h2 class="m-0 px-4 py-3 bg-zinc-800 border-b border-zinc-700 font-semibold">Kaart 2</h2>
      <div class="p-3">
        <div class="map">
          <svg viewBox="0 0 1600 900" class="w-full h-auto">
            <image href="https://picsum.dev/1600/900?grayscale" x="0" y="0" width="1600" height="900" />
          </svg>
        </div>
      </div>
    </div>
    <aside class="bg-zinc-900 border border-zinc-800 rounded-xl overflow-hidden">
      <h2 class="m-0 px-4 py-3 bg-zinc-800 border-b border-zinc-700 font-semibold">Je selectie</h2>
      <div class="p-3">
        <div id="list2" class="grid gap-2"></div>
      </div>
    </aside>
  </section>

  <!-- Checkout -->
  <section id="checkout" class="max-w-6xl mx-auto p-4 hidden">
    <div class="max-w-xl mx-auto bg-zinc-900 border border-zinc-800 rounded-xl overflow-hidden">
      <h2 class="m-0 px-4 py-3 bg-zinc-800 border-b border-zinc-700 font-semibold">Mandje & Versturen</h2>
      <div class="p-4 space-y-3">
        <div id="checkoutList" class="grid gap-2"></div>
        <label for="email" class="block text-zinc-400 text-sm">E-mailadres om links/PDF's te ontvangen</label>
        <input id="email" type="email" placeholder="jij@example.nl" class="w-full h-12 rounded-lg border border-zinc-700 bg-zinc-950 text-zinc-100 px-3 outline-none focus:ring-2 focus:ring-emerald-500/40 focus:border-emerald-500" />
        <button class="w-full justify-center inline-flex items-center gap-2 rounded-lg bg-emerald-500 text-black font-bold px-4 py-3" id="sendLinks">E-mail downloadlinks</button>
        <button class="w-full justify-center inline-flex items-center gap-2 rounded-lg bg-zinc-800 text-zinc-100 font-bold px-4 py-3" id="sendAttachments">E-mail met bijlagen</button>
        <div id="status" class="text-sm text-zinc-400"></div>
      </div>
    </div>
  </section>

  <!-- Lightbox / modal -->
  <div id="modalOverlay" class="fixed inset-0 bg-black/60 hidden z-50">
    <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[min(92vw,820px)] max-h-[80vh] overflow-auto bg-zinc-900 border border-zinc-800 rounded-2xl shadow-2xl">
      <header class="sticky top-0 px-4 py-3 bg-zinc-800 border-b border-zinc-700 flex items-center justify-between">
        <h3 id="modalTitle" class="font-semibold">Titel</h3>
        <button id="modalClose" class="rounded-md px-2 py-1 hover:bg-zinc-700">✕</button>
      </header>
      <div class="p-4 space-y-3">
        <div id="modalDesc" class="text-sm text-zinc-400">Beschrijving…</div>
        <div id="modalList" class="grid gap-2"></div>
        <div class="flex justify-end">
          <button id="modalSelectAll" class="inline-flex items-center gap-2 rounded-lg bg-emerald-500 text-black font-bold px-4 py-2">Alles toevoegen aan mandje</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    'use strict';
    // --------- Data ---------
    const HOTSPOTS = {
      page1: [
        {
          id: 'zone-a',
          title: 'Informatiepunt A',
          desc: 'Hier vind je meer over duurzaam sparen en onze groene spaarrekeningen.',
          brochures: [
            { title: 'Duurzaam Sparen – Intro', url: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf' },
            { title: 'Duurzaam Sparen – Voorwaarden', url: 'https://www.africau.edu/images/default/sample.pdf' }
          ],
          shape: { type: 'rect', x: 220, y: 220, w: 320, h: 180 }
        },
        {
          id: 'zone-b',
          title: 'Informatiepunt B',
          desc: 'Meer weten over groene hypotheken en rentekortingen?',
          brochures: [
            { title: 'Groene Hypotheek – Brochure', url: 'https://file-examples.com/storage/fe9be1f7d5c632c2a7b9b7a/2017/10/file-example_PDF_1MB.pdf' }
          ],
          shape: { type: 'circle', cx: 1150, cy: 520, r: 120 }
        }
      ],
      page2: [
        {
          id: 'zone-c',
          title: 'Informatiepunt C',
          desc: 'Impact beleggen: rendement én positieve impact.',
          brochures: [
            { title: 'Impact Beleggen – Overzicht', url: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf' },
            { title: 'Impact Beleggen – Cases', url: 'https://file-examples.com/storage/fe9be1f7d5c632c2a7b9b7a/2017/10/file-example_PDF_1MB.pdf' }
          ],
          shape: { type: 'poly', points: [[1200,220],[1500,260],[1460,520],[1220,480]] }
        }
      ]
    };

    // --------- Cart (per brochure) ---------
    const selected = new Map(); // key => {title, pdfUrl}
    const keyFor = (hotspotId, idx) => `${hotspotId}::${idx}`;

    function renderCartCount(){
      const badge=document.getElementById('cartCount');
      if(badge) badge.textContent=String(selected.size);
    }

    function renderList(page){
      const list = document.getElementById('list'+page.slice(-1));
      if(!list) return;
      list.innerHTML = '';
      for(const h of HOTSPOTS[page]){
        let count = 0; (h.brochures||[]).forEach((_,i)=>{ if(selected.has(keyFor(h.id,i))) count++; });
        const item = document.createElement('div'); item.className='bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 flex items-center justify-between';
        const left = document.createElement('span'); left.textContent = count ? `${h.title} · ${count}/${h.brochures.length} geselecteerd` : h.title;
        const btn = document.createElement('button'); btn.className='inline-flex items-center gap-2 rounded-md bg-zinc-700 text-zinc-100 px-3 py-2'; btn.textContent='Meer info';
        btn.addEventListener('click', ()=> openModal(h));
        item.appendChild(left); item.appendChild(btn); list.appendChild(item);
      }
    }

    function renderCheckout(){
      const list = document.getElementById('checkoutList');
      list.innerHTML='';
      if(selected.size===0){ const empty=document.createElement('div'); empty.className='text-sm text-zinc-400'; empty.textContent='Nog geen items in het mandje.'; list.appendChild(empty); return; }
      for (const [id, data] of selected.entries()) {
        const item = document.createElement('div'); item.className = 'bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 flex items-center justify-between';
        const left = document.createElement('span'); left.textContent = data.title;
        const right = document.createElement('div'); right.className='flex items-center gap-2';
        const preview = document.createElement('a'); preview.href=data.pdfUrl; preview.target='_blank'; preview.rel='noopener noreferrer'; preview.textContent='Voorbeeld'; preview.className='underline text-emerald-200';
        const btn = document.createElement('button'); btn.className = 'rounded-md bg-zinc-700 px-2 py-1'; btn.textContent = 'Verwijder';
        btn.addEventListener('click', () => { selected.delete(id); renderAll(); renderHotspots(); });
        right.appendChild(preview); right.appendChild(btn);
        item.appendChild(left); item.appendChild(right);
        list.appendChild(item);
      }
    }

    function renderAll(){ renderList('page1'); renderList('page2'); renderCheckout(); renderCartCount(); }

    // --------- Hotspots tekenen ---------
    function labelCenter(shape){
      if(shape.type==='rect'){ return [shape.x + shape.w/2, shape.y + shape.h/2]; }
      if(shape.type==='circle'){ return [shape.cx, shape.cy]; }
      if(shape.type==='poly'){
        let x=0,y=0; for(const p of shape.points){ x+=p[0]; y+=p[1]; }
        return [x/shape.points.length, y/shape.points.length];
      }
      return [0,0];
    }

    function renderHotspotsForPage(pageId){
      const page = document.getElementById(pageId);
      if(!page) return;
      const svg = page.querySelector('svg');
      if(!svg) return;
      svg.querySelectorAll('[data-hotspot]').forEach(n=>n.remove());
      const items = HOTSPOTS[pageId] || [];
      for(const h of items){
        if(!h.shape) continue;
        const g = document.createElementNS('http://www.w3.org/2000/svg','g');
        g.setAttribute('data-hotspot', h.id);
        let shapeEl;
        if(h.shape.type==='rect'){
          shapeEl = document.createElementNS('http://www.w3.org/2000/svg','rect');
          shapeEl.setAttribute('x', h.shape.x);
          shapeEl.setAttribute('y', h.shape.y);
          shapeEl.setAttribute('width', h.shape.w);
          shapeEl.setAttribute('height', h.shape.h);
          shapeEl.setAttribute('rx', 18);
        } else if(h.shape.type==='circle'){
          shapeEl = document.createElementNS('http://www.w3.org/2000/svg','circle');
          shapeEl.setAttribute('cx', h.shape.cx);
          shapeEl.setAttribute('cy', h.shape.cy);
          shapeEl.setAttribute('r', h.shape.r);
        } else if(h.shape.type==='poly'){
          shapeEl = document.createElementNS('http://www.w3.org/2000/svg','polygon');
          shapeEl.setAttribute('points', h.shape.points.map(p=>p.join(',')).join(' '));
        }
        shapeEl.setAttribute('class', 'fill-emerald-500/30 stroke-emerald-500 stroke-[3] cursor-pointer');
        shapeEl.setAttribute('tabindex','0');
        shapeEl.setAttribute('role','button');
        shapeEl.addEventListener('click', ()=> openModal(h));
        shapeEl.addEventListener('keydown', e=>{ if(e.key==='Enter'||e.key===' ') openModal(h); });
        g.appendChild(shapeEl);

        const [tx, ty] = labelCenter(h.shape);
        const label = document.createElementNS('http://www.w3.org/2000/svg','text');
        label.setAttribute('x', tx);
        label.setAttribute('y', ty);
        label.setAttribute('text-anchor','middle');
        label.setAttribute('dominant-baseline','central');
        label.setAttribute('class','fill-white font-bold pointer-events-none');
        label.textContent = h.title;
        g.appendChild(label);

        svg.appendChild(g);
      }
    }

    function renderHotspots(){
      renderHotspotsForPage('page1');
      renderHotspotsForPage('page2');
    }

    // --------- Lightbox logic (per brochure) ---------
    const overlay = document.getElementById('modalOverlay');
    const modalTitle = document.getElementById('modalTitle');
    const modalDesc = document.getElementById('modalDesc');
    const modalList = document.getElementById('modalList');
    const modalSelectAll = document.getElementById('modalSelectAll');
    const modalClose = document.getElementById('modalClose');

    function openModal(h){
      modalTitle.textContent = h.title;
      modalDesc.textContent = h.desc || '';
      modalList.innerHTML = '';

      (h.brochures||[{title:h.title, url:h.pdfUrl}]).forEach((b, i) => {
        const key = keyFor(h.id, i);
        const checked = selected.has(key);

        const row = document.createElement('div'); row.className = 'flex items-center justify-between gap-2 bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2';
        const left = document.createElement('div'); left.className = 'flex items-center gap-2';

        const cb = document.createElement('input'); cb.type='checkbox'; cb.checked = checked; cb.id = key;
        const lbl = document.createElement('label'); lbl.setAttribute('for', key); lbl.textContent = b.title;
        left.appendChild(cb); left.appendChild(lbl);

        const actions = document.createElement('div'); actions.className='flex items-center gap-2';
        const preview = document.createElement('a'); preview.href = b.url; preview.target='_blank'; preview.rel='noopener noreferrer'; preview.textContent='Voorbeeld'; preview.className='underline text-emerald-200';
        actions.appendChild(preview);

        row.appendChild(left); row.appendChild(actions);
        modalList.appendChild(row);

        cb.addEventListener('change', ()=>{
          if(cb.checked){ selected.set(key, { title: b.title, pdfUrl: b.url }); }
          else { selected.delete(key); }
          renderAll();
        });
      });

      modalSelectAll.onclick = () => {
        const allChecked = (h.brochures||[{title:h.title, url:h.pdfUrl}]).every((_, i) => selected.has(keyFor(h.id,i)));
        if(allChecked){ (h.brochures||[{title:h.title, url:h.pdfUrl}]).forEach((_, i)=> selected.delete(keyFor(h.id,i))); }
        else { (h.brochures||[{title:h.title, url:h.pdfUrl}]).forEach((b, i)=> selected.set(keyFor(h.id,i), { title: b.title, pdfUrl: b.url })); }
        openModal(h); // re-render
        renderAll();
      };

      overlay.classList.remove('hidden');
    }

    function closeModal(){ overlay.classList.add('hidden'); }
    overlay.addEventListener('click', (e)=>{ if(e.target===overlay) closeModal(); });
    modalClose.addEventListener('click', closeModal);
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && !overlay.classList.contains('hidden')) closeModal(); });

    // --------- E-mail flow ---------
    async function handleSend(mode){
      const email=document.getElementById('email').value.trim();
      const status=document.getElementById('status');
      if(!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email)){ status.textContent='Ongeldig e-mailadres'; return; }
      const items=Array.from(selected.values());
      if(!items.length){ status.textContent='Leeg mandje'; return; }
      status.textContent='Verzenden…';
      await new Promise(r=>setTimeout(r,800));
      status.textContent='Verzonden ('+mode+') naar '+email;
    }

    document.getElementById('sendLinks').addEventListener('click', ()=>handleSend('links'));
    document.getElementById('sendAttachments').addEventListener('click', ()=>handleSend('attachments'));

    // --------- Navigatie ---------
    const navButtons = document.querySelectorAll('header nav button');
    navButtons.forEach(btn=>{
      btn.addEventListener('click',()=>{
        // pages
        ['page1','page2','checkout'].forEach(id=> document.getElementById(id).classList.add('hidden'));
        document.getElementById(btn.dataset.page).classList.remove('hidden');
        // active state
        navButtons.forEach(b=> b.className = 'px-3 py-2 rounded-md bg-zinc-800 text-zinc-100');
        btn.className = 'px-3 py-2 rounded-md bg-emerald-500 text-black font-semibold';
        // rerender
        renderHotspots();
        renderAll();
      });
    });

    // --------- Boot ---------
    renderAll();
    renderHotspots();
  </script>
</body>
</html>
